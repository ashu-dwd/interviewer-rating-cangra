<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interview Evaluator AI</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
        --primary: #4361ee;
        --primary-dark: #3a0ca3;
        --primary-light: #7389f4;
        --success: #2ecc71;
        --danger: #e63946;
        --warning: #ff9f1c;
        --dark: #2b2d42;
        --light: #f8f9fa;
        --gray: #8d99ae;
        --white: #ffffff;
        --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
        --transition: all 0.3s ease-in-out;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background-color: #f5f8ff;
        color: var(--dark);
        line-height: 1.6;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      header {
        background: linear-gradient(
          135deg,
          var(--primary-dark),
          var(--primary)
        );
        color: white;
        padding: 1.5rem 2rem;
        box-shadow: var(--shadow);
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .header-content {
        display: flex;
        align-items: center;
        max-width: 1400px;
        margin: 0 auto;
      }

      .header-icon {
        margin-right: 15px;
        font-size: 2rem;
      }

      .main-container {
        display: flex;
        flex: 1;
        padding: 30px;
        gap: 30px;
        flex-wrap: wrap;
        max-width: 1400px;
        margin: 0 auto;
      }

      .input-section,
      .results-section {
        background: var(--white);
        border-radius: 12px;
        box-shadow: var(--shadow);
        padding: 25px;
        flex: 1;
        min-width: 300px;
        transition: var(--transition);
      }

      .input-section:hover,
      .results-section:hover {
        box-shadow: var(--shadow-lg);
      }

      .input-section {
        display: flex;
        flex-direction: column;
      }

      .section-header {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid #eef2ff;
      }

      .section-icon {
        color: var(--primary);
        margin-right: 12px;
        font-size: 1.8rem;
      }

      h2 {
        color: var(--dark);
        font-weight: 600;
      }

      .form-group {
        margin-bottom: 20px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: var(--dark);
      }

      input,
      textarea {
        width: 100%;
        padding: 12px;
        border: 1px solid #dce1ed;
        border-radius: 8px;
        font-size: 16px;
        transition: var(--transition);
      }

      input:focus,
      textarea:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.15);
      }

      textarea {
        min-height: 120px;
        resize: vertical;
      }

      button {
        background-color: var(--primary);
        color: white;
        border: none;
        padding: 14px 24px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 600;
        margin-top: 15px;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
      }

      button:hover {
        background-color: var(--primary-dark);
        transform: translateY(-2px);
      }

      button:active {
        transform: translateY(0);
      }

      .loading {
        display: none;
        text-align: center;
        padding: 30px;
      }

      .spinner {
        border: 4px solid rgba(67, 97, 238, 0.1);
        border-radius: 50%;
        border-top: 4px solid var(--primary);
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin: 20px auto;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .error-message {
        color: var(--danger);
        background-color: rgba(230, 57, 70, 0.1);
        border-left: 4px solid var(--danger);
        padding: 12px;
        margin-top: 15px;
        border-radius: 4px;
        display: none;
      }

      .results-container {
        display: none;
      }

      .rating-card {
        background-color: var(--white);
        border-radius: 12px;
        box-shadow: var(--shadow);
        margin-bottom: 25px;
        overflow: hidden;
      }

      .rating-header {
        background: linear-gradient(
          135deg,
          var(--primary),
          var(--primary-light)
        );
        color: white;
        padding: 18px 20px;
        font-size: 18px;
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .rating-body {
        padding: 20px;
      }

      .rating-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid #eef2ff;
      }

      .rating-item:last-child {
        border-bottom: none;
      }

      .rating-label {
        font-weight: 600;
        font-size: 16px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .rating-icon {
        color: var(--primary);
      }

      .rating-value {
        font-weight: bold;
        background-color: var(--primary);
        color: white;
        padding: 6px 12px;
        border-radius: 20px;
        min-width: 45px;
        text-align: center;
      }

      .rating-value.high {
        background-color: var(--success);
      }

      .rating-value.medium {
        background-color: var(--warning);
      }

      .rating-value.low {
        background-color: var(--danger);
      }

      .rating-feedback {
        font-size: 14px;
        color: var(--gray);
        margin-top: 8px;
        padding-right: 50px;
      }

      .list-section {
        margin-top: 20px;
      }

      .list-section h4 {
        margin-bottom: 12px;
        color: var(--dark);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .list-section-icon {
        color: var(--primary);
      }

      .list-items {
        list-style-type: none;
      }

      .list-items li {
        background-color: #f8f9ff;
        padding: 12px 15px;
        margin-bottom: 8px;
        border-radius: 6px;
        font-size: 14px;
        display: flex;
        align-items: flex-start;
        gap: 10px;
      }

      .list-item-icon {
        color: var(--primary);
        margin-top: 2px;
      }

      .strengths .list-item-icon {
        color: var(--success);
      }

      .improvements .list-item-icon {
        color: var(--warning);
      }

      .missed-skills .list-item-icon {
        color: var(--danger);
      }

      .recommendations .list-item-icon {
        color: var(--primary);
      }

      .overall-container {
        text-align: center;
        background: linear-gradient(135deg, #f8f9ff, #eef2ff);
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 25px;
        box-shadow: var(--shadow);
      }

      .overall-score-wrapper {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 15px;
      }

      .overall-score {
        font-size: 64px;
        font-weight: bold;
        color: var(--primary);
        line-height: 1;
      }

      .score-scale {
        font-size: 18px;
        color: var(--gray);
        margin-left: 5px;
        align-self: flex-end;
        margin-bottom: 15px;
      }

      .overall-summary {
        text-align: center;
        margin-bottom: 10px;
        padding: 0 20px;
        font-size: 16px;
        line-height: 1.6;
        color: var(--dark);
      }

      .progress-bar-wrapper {
        width: 100%;
        height: 10px;
        background-color: rgba(67, 97, 238, 0.1);
        border-radius: 5px;
        margin-top: 20px;
      }

      .progress-bar {
        height: 100%;
        border-radius: 5px;
        background: linear-gradient(90deg, var(--primary-dark), var(--primary));
        transition: width 1s ease-in-out;
      }

      .tooltip {
        position: relative;
        display: inline-block;
      }

      .tooltip .tooltip-text {
        visibility: hidden;
        width: 200px;
        background-color: var(--dark);
        color: var(--white);
        text-align: center;
        border-radius: 6px;
        padding: 8px;
        position: absolute;
        z-index: 1;
        bottom: 125%;
        left: 50%;
        margin-left: -100px;
        opacity: 0;
        transition: opacity 0.3s;
        font-size: 14px;
      }

      .tooltip:hover .tooltip-text {
        visibility: visible;
        opacity: 0.9;
      }

      @media (max-width: 768px) {
        .main-container {
          flex-direction: column;
          padding: 15px;
        }

        .input-section,
        .results-section {
          width: 100%;
          padding: 20px;
        }

        header {
          padding: 1rem 1.5rem;
        }

        .overall-score {
          font-size: 48px;
        }

        .rating-feedback {
          padding-right: 0;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="header-content">
        <i class="fa-solid fa-comments-dollar header-icon"></i>
        <h1>Interview Evaluator AI</h1>
      </div>
    </header>

    <div class="main-container">
      <section class="input-section">
        <div class="section-header">
          <i class="fa-solid fa-clipboard-question section-icon"></i>
          <h2>Evaluate Interview</h2>
        </div>
        <form id="evaluationForm">
          <div class="form-group">
            <label for="candidateName">
              <i class="fa-solid fa-user"></i> Candidate Name:
            </label>
            <input
              type="text"
              id="candidateName"
              name="candidateName"
              required
              placeholder="Enter candidate name"
            />
          </div>

          <div class="form-group">
            <label for="candidateExperience">
              <i class="fa-solid fa-briefcase"></i> Candidate Experience
              (years):
            </label>
            <input
              type="number"
              id="candidateExperience"
              name="candidateExperience"
              required
              min="0"
              step="0.5"
              placeholder="Enter years of experience"
            />
          </div>

          <div class="form-group">
            <label for="skillsToRate">
              <i class="fa-solid fa-code"></i> Skills to Rate:
            </label>
            <input
              type="text"
              id="skillsToRate"
              name="skillsToRate"
              required
              placeholder="e.g. Salesforce, Apex, Lightning Web Components"
            />
          </div>

          <div class="form-group">
            <label for="mandatorySkills">
              <i class="fa-solid fa-circle-check"></i> Mandatory Skills:
            </label>
            <textarea
              id="mandatorySkills"
              name="mandatorySkills"
              required
              placeholder="List the mandatory skills for this position"
            ></textarea>
          </div>

          <div class="form-group">
            <label for="interviewTranscript">
              <i class="fa-solid fa-file-lines"></i> Interview Transcript:
            </label>
            <textarea
              id="interviewTranscript"
              name="interviewTranscript"
              required
              placeholder="Paste the full interview transcript here"
            ></textarea>
          </div>

          <button type="submit" id="evaluateBtn">
            <i class="fa-solid fa-magnifying-glass"></i> Evaluate Interview
          </button>
        </form>

        <div class="error-message" id="errorMessage">
          <i class="fa-solid fa-circle-exclamation"></i>
          <span id="errorText"></span>
        </div>
      </section>

      <section class="results-section">
        <div class="section-header">
          <i class="fa-solid fa-chart-simple section-icon"></i>
          <h2>Evaluation Results</h2>
        </div>

        <div class="loading" id="loadingIndicator">
          <div class="spinner"></div>
          <p>
            <i class="fa-solid fa-robot"></i> AI is analyzing the interview...
          </p>
        </div>

        <div class="results-container" id="resultsContainer">
          <div class="overall-container">
            <div class="overall-score-wrapper">
              <div class="overall-score" id="overallScore">0.0</div>
              <div class="score-scale">/10</div>
            </div>
            <p class="overall-summary" id="overallSummary"></p>
            <div class="progress-bar-wrapper">
              <div class="progress-bar" id="overallProgressBar"></div>
            </div>
          </div>

          <div class="rating-card">
            <div class="rating-header">
              <i class="fa-solid fa-star"></i> Category Ratings
            </div>
            <div class="rating-body" id="categoryRatings">
              <!-- Category ratings will be inserted here by JavaScript -->
            </div>
          </div>

          <div class="rating-card">
            <div class="rating-header">
              <i class="fa-solid fa-magnifying-glass-chart"></i> Analysis
            </div>
            <div class="rating-body">
              <div class="list-section">
                <h4>
                  <i class="fa-solid fa-thumbs-up list-section-icon"></i>
                  Strengths
                </h4>
                <ul class="list-items strengths" id="strengthsList">
                  <!-- Strengths will be inserted here by JavaScript -->
                </ul>
              </div>

              <div class="list-section">
                <h4>
                  <i
                    class="fa-solid fa-triangle-exclamation list-section-icon"
                  ></i>
                  Areas for Improvement
                </h4>
                <ul class="list-items improvements" id="improvementsList">
                  <!-- Improvement areas will be inserted here by JavaScript -->
                </ul>
              </div>

              <div class="list-section">
                <h4>
                  <i class="fa-solid fa-xmark list-section-icon"></i> Missed
                  Skills
                </h4>
                <ul class="list-items missed-skills" id="missedSkillsList">
                  <!-- Missed skills will be inserted here by JavaScript -->
                </ul>
              </div>

              <div class="list-section">
                <h4>
                  <i class="fa-solid fa-lightbulb list-section-icon"></i>
                  Recommendations
                </h4>
                <ul class="list-items recommendations" id="recommendationsList">
                  <!-- Recommendations will be inserted here by JavaScript -->
                </ul>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("evaluationForm");
        const loadingIndicator = document.getElementById("loadingIndicator");
        const resultsContainer = document.getElementById("resultsContainer");
        const errorMessage = document.getElementById("errorMessage");
        const errorText = document.getElementById("errorText");

        // For demo purposes, you can use this sample data
        const sampleData = {
          overall_rating: {
            score: 7,
            summary:
              "The interviewer conducted a reasonably thorough interview, covering several key Salesforce concepts and technologies. However, some questions lacked depth, and the interview could have been better structured for optimal skill assessment. The interviewer provided constructive feedback, which is a positive aspect.",
          },
          category_ratings: {
            relevance: {
              score: 8,
              feedback:
                "The majority of the questions were relevant to the Salesforce platform and the listed skills to rate. The interviewer touched upon Apex, LWC, integrations, and deployments, which are all pertinent to a Salesforce developer role.",
            },
            technical_depth: {
              score: 6,
              feedback:
                "While the interviewer covered several technical topics, some questions lacked the depth needed to truly assess the candidate's expertise. For instance, the questions on integrations and deployments could have been more specific and challenging. The whiteboard coding exercise was good for assessing coding skills.",
            },
            communication: {
              score: 8,
              feedback:
                "The interviewer's communication was generally clear and professional. The interviewer provided clear instructions for the coding exercise. The interviewer also provided useful feedback at the end.",
            },
            skill_coverage: {
              score: 7,
              feedback:
                "The interviewer covered Apex (sync and async), LWC, and REST APIs. DevOps/Salesforce Tools were touched upon but could have been explored further. Overall skill coverage was adequate but not comprehensive.",
            },
            structure: {
              score: 6,
              feedback:
                "The interview lacked a clear structure. The topics seemed to jump around without a logical flow. A more structured approach, with dedicated time for each key skill area, would have been beneficial.",
            },
            follow_up_quality: {
              score: 7,
              feedback:
                "Some follow-up questions were good, such as probing the candidate's understanding of mixed DML exceptions and asynchronous methods. However, some answers were accepted without sufficient follow-up to verify true understanding.",
            },
            time_management: {
              score: 7,
              feedback:
                "The interview seemed to utilize the time well enough, covering several topics. The coding exercise consumed a significant portion of the time. A more focused approach could have allowed for a deeper dive into specific areas.",
            },
          },
          strengths: [
            "Good coverage of multiple Salesforce topics.",
            "Included a practical coding exercise.",
            "Provided constructive feedback to the candidate.",
          ],
          improvement_areas: [
            "Improve interview structure for better flow and topic organization.",
            "Increase the technical depth of questions in certain areas (e.g., integrations, deployments).",
            "Improve follow-up questioning to verify the candidate's understanding thoroughly.",
          ],
          missed_skills: [
            "More in depth review of DevOps/Salesforce Tools experience.",
          ],
          recommendations: [
            "Develop a more structured interview format with specific time allocations for each skill area.",
            "Create a bank of more challenging technical questions to assess deeper expertise.",
            "Focus on active listening and asking clarifying questions to ensure a thorough understanding of the candidate's responses.",
          ],
        };

        form.addEventListener("submit", function (e) {
          e.preventDefault();

          // Hide any previous results or errors
          resultsContainer.style.display = "none";
          errorMessage.style.display = "none";
          loadingIndicator.style.display = "block";

          // Get form data
          const formData = new FormData(form);

          // Convert to plain object
          const data = {};
          formData.forEach((value, key) => {
            data[key] = value;
          });

          // Simulate API call with a timeout (replace with actual API call)
          setTimeout(() => {
            try {
              // Use the sample data for demonstration
              displayResults(sampleData);
              loadingIndicator.style.display = "none";
              resultsContainer.style.display = "block";
            } catch (error) {
              console.error("Error:", error);
              errorText.textContent = `${
                error.message || "Failed to evaluate interview"
              }`;
              errorMessage.style.display = "block";
              loadingIndicator.style.display = "none";
            }
          }, 2000);

          // In a real implementation, you would use fetch:
          /*
          fetch("https://interviewer-rating-cangra.onrender.com/api/v1/gen", {
            method: "POST",
            headers: {
              "Content-Type": "application/x-www-form-urlencoded",
            },
            body: new URLSearchParams(data),
          })
            .then((response) => {
              if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
              }
              return response.json();
            })
            .then((data) => {
              displayResults(data);
              loadingIndicator.style.display = "none";
              resultsContainer.style.display = "block";
            })
            .catch((error) => {
              console.error("Error:", error);
              errorText.textContent = `${error.message || "Failed to evaluate interview"}`;
              errorMessage.style.display = "block";
              loadingIndicator.style.display = "none";
            });
          */
        });

        function displayResults(data) {
          // Check if the data structure is as expected
          if (!data || !data.overall_rating || !data.category_ratings) {
            throw new Error("Invalid response data structure");
          }

          // Set overall score and summary
          const overallScore = document.getElementById("overallScore");
          const overallSummary = document.getElementById("overallSummary");
          const overallProgressBar =
            document.getElementById("overallProgressBar");

          // Safely access the data
          const score = data.overall_rating.score;

          if (score !== undefined) {
            overallScore.textContent = score.toFixed(1);
            overallProgressBar.style.width = `${score * 10}%`;

            // Set color based on score
            if (score >= 8) {
              overallScore.style.color = "var(--success)";
            } else if (score >= 6) {
              overallScore.style.color = "var(--warning)";
            } else {
              overallScore.style.color = "var(--danger)";
            }
          } else {
            overallScore.textContent = "N/A";
            overallProgressBar.style.width = "0%";
          }

          if (data.overall_rating.summary) {
            overallSummary.textContent = data.overall_rating.summary;
          } else {
            overallSummary.textContent = "No summary available.";
          }

          // Display category ratings
          const categoryRatingsElement =
            document.getElementById("categoryRatings");
          categoryRatingsElement.innerHTML = "";

          const categoryIcons = {
            relevance: "fa-solid fa-bullseye",
            technical_depth: "fa-solid fa-microchip",
            communication: "fa-solid fa-comments",
            skill_coverage: "fa-solid fa-code",
            structure: "fa-solid fa-sitemap",
            follow_up_quality: "fa-solid fa-reply-all",
            time_management: "fa-solid fa-clock",
          };

          if (
            data.category_ratings &&
            Object.keys(data.category_ratings).length > 0
          ) {
            for (const [category, rating] of Object.entries(
              data.category_ratings
            )) {
              if (!rating || typeof rating !== "object") continue;

              const formattedCategory = category
                .split("_")
                .map((word) => word.charAt(0).toUpperCase() + word.slice(1))
                .join(" ");

              const icon = categoryIcons[category] || "fa-solid fa-star";
              const ratingScore = rating.score !== undefined ? rating.score : 0;

              // Determine rating class based on score
              let ratingClass = "medium";
              if (ratingScore >= 8) {
                ratingClass = "high";
              } else if (ratingScore <= 5) {
                ratingClass = "low";
              }

              const ratingItem = document.createElement("div");
              ratingItem.className = "rating-item";
              ratingItem.innerHTML = `
                <div>
                  <div class="rating-label">
                    <i class="${icon} rating-icon"></i>
                    ${formattedCategory}
                    <span class="tooltip">
                      <i class="fa-solid fa-circle-info"></i>
                      <span class="tooltip-text">This rating evaluates the ${category.replace(
                        /_/g,
                        " "
                      )} aspect of the interview.</span>
                    </span>
                  </div>
                  <div class="rating-feedback">${
                    rating.feedback || "No feedback available."
                  }</div>
                </div>
                <div class="rating-value ${ratingClass}">${ratingScore.toFixed(
                1
              )}</div>
              `;

              categoryRatingsElement.appendChild(ratingItem);
            }
          } else {
            const noRatings = document.createElement("div");
            noRatings.textContent = "No category ratings available.";
            categoryRatingsElement.appendChild(noRatings);
          }

          // Display lists
          populateList("strengthsList", data.strengths, "fa-solid fa-check");
          populateList(
            "improvementsList",
            data.improvement_areas,
            "fa-solid fa-arrows-spin"
          );
          populateList(
            "missedSkillsList",
            data.missed_skills,
            "fa-solid fa-xmark"
          );
          populateList(
            "recommendationsList",
            data.recommendations,
            "fa-solid fa-circle-arrow-right"
          );
        }

        function populateList(elementId, items, iconClass) {
          const listElement = document.getElementById(elementId);
          listElement.innerHTML = "";

          if (!items || items.length === 0) {
            const li = document.createElement("li");
            li.innerHTML = `<i class="fa-solid fa-circle-info list-item-icon"></i> None identified`;
            listElement.appendChild(li);
            return;
          }

          items.forEach((item) => {
            const li = document.createElement("li");
            li.innerHTML = `<i class="${iconClass} list-item-icon"></i> ${item}`;
            listElement.appendChild(li);
          });
        }
      });
    </script>
  </body>
</html>
